"use strict";(self.webpackChunktahos_lat=self.webpackChunktahos_lat||[]).push([[2,339,914],{79850:function(e,n,t){t.r(n);var a=t(89379),i=t(80045),r=t(5544),l=t(9950),d=t(54408),o=t(10300),s=t(45131),u=t(95250),c=t(82109),m=t(4297),f=t(83137),p=t(49389),v=t(65510),h=t(85167),A=t(44414),y=["urlQuery"];n.default=(0,l.memo)((0,d.Ay)(function(e){var n=e.clientId,t=e.clientIdQuery,d=void 0===t?"":t,w=e.helmet,g=e.intl.formatMessage,b=(0,o.d4)(function(e){return e.dataTable}),x=b.search_query,_=b.local_query,j=(0,o.wA)(),I=(0,c.w)({roleNames:["superadmin","admin","podadmin"]}),C=(0,r.A)(I,1)[0],M=(0,u.X)({url:"/priority/list.php",keepQuery:!0}),D=M.data,q=M.loading,k=(0,m.c)({clientId:n,clientIdQuery:d,noStatus:!0,formatMessage:g}),Q=k.urlQuery,N=(0,i.A)(k,y),S=(0,u.X)({url:"/alarms/list.php?delay=1".concat(Q),hasRefetch:!0,keepQuery:!0,customSuccessCallback:function(e){return!x&&(n=null===e||void 0===e?void 0:e.length,j(s.XA(n)));var n}}),F=S.data,T=S.loading,Y=(0,l.useMemo)(function(){return null===F||void 0===F?void 0:F.map(function(e,n){return(0,a.A)((0,a.A)({},e),{},{orderId:n+1,priority:(0,f.fb)({arrayData:D,value:null===e||void 0===e?void 0:e.priority}),copy_expiration_date:(0,f._b)(null===e||void 0===e?void 0:e.expiration_date,"d.M.yyyy")})})},[F,D]),L=(0,l.useMemo)(function(){return{name:g({id:"client.name"}),driver:g({id:"nav.drivers"}),vehicle:g({id:"nav.vehicles.and.trailers"}),alarm_type:g({id:"alarm.type"}),num_dates_from:g({id:"alarm.num.dates.from"}),num_dates_to:g({id:"alarm.num.dates.to"}),deadline_to:g({id:"alarm.deadline.to"})}},[g]);return(0,A.jsxs)(A.Fragment,{children:[null===w||void 0===w?void 0:w(g),(0,A.jsx)(p.A,(0,a.A)({search_type:"alarms",fieldLabels:L,roleCondition:C&&!n},N)),(0,A.jsx)(v.A,{localOnly:!0,hasRefresh:!0}),(0,A.jsx)(h.A,{type:"alarms",data:(0,f.CB)(Y,_),loading:T||q})]})}))},87628:function(e,n,t){t.r(n),t.d(n,{default:function(){return le}});var a=t(89379),i=t(60436),r=t(80045),l=t(5544),d=t(9950),o=t(54408),s=t(10300),u=t(83137),c=t(95250),m=t(4297),f=t(82109),p=t(49389),v=t(27162),h=t(65510),A=t(67078),y=t(61794),w=t(91212),g=t(10467),b=t(20454),x=t(45131),_=t(93320),j=t(73275),I=t(88142),C=t(17419),M=t(70298),D=t(70742),q=t(39412),k=t(80901),Q=t(83325),N=t(49395),S=t(2105),F=t(84142),T=t(14857),Y=t(13633),L=t(20032),R=t(44414),W=["children","value","index"],X=function(e){var n=e.children,t=e.value,i=e.index,l=(0,r.A)(e,W);return(0,R.jsx)("div",(0,a.A)((0,a.A)({role:"tabpanel",hidden:t!==i,id:"full-width-tabpanel-".concat(i),"aria-labelledby":"full-width-tab-".concat(i)},l),{},{children:!(t!==i)&&(0,R.jsx)(L.A,{sx:{pt:2},children:n})}))},B=(0,d.memo)(X),H=t(92578),O=t(71260),P=t(85452),U=t(79850),E=t(64872),K=t(95135),G=t(75163),V=t(72499),z=t(53085),J=t(82544),Z=t(22609),$=t(85546),ee=t(29714),ne=function(e){return(0,a.A)({email_notification:"",type:null},!(null!==e&&void 0!==e&&e.id)&&{name:"",pib:"",user_name:"",username:"",password:"",password_repeat:""})},te=function(e){var n=e.fieldLabels,t=e.formatMessage,i=e.editData;return(0,ee.Ik)().shape((0,a.A)({email_notification:(0,ee.Yj)().email(t({id:"email.validation"})).required((0,$.w)(t,n.email_notification,"required")),type:(0,ee.Ik)().required((0,$.w)(t,n.type,"filter"))},!(null!==i&&void 0!==i&&i.id)&&{name:(0,ee.Yj)().required((0,$.w)(t,n.name,"required")),pib:(0,ee.Yj)().required((0,$.w)(t,n.pib,"required")),user_name:(0,ee.Yj)().required((0,$.w)(t,n.user_name,"required")),username:(0,ee.Yj)().email(t({id:"email.validation"})).required((0,$.w)(t,n.username,"required")),password:(0,ee.Yj)().min(8,(0,$.w)(t,n.password,"password")).concat(i?null:(0,ee.Yj)().required((0,$.w)(t,n.password,"required"))),password_repeat:(0,ee.Yj)().oneOf([(0,ee.KR)("password")],t({id:"not.the.same.password"})).concat(i?null:(0,ee.Yj)().required((0,$.w)(t,n.password_repeat,"required")))}))},ae=["type","password","password_repeat"],ie=(0,d.memo)((0,o.Ay)(function(e){var n=e.modal,t=e.handleClose,i=e.editData,o=e.fieldLabels,c=e.columns,m=e.fullColumns,f=e.dataAll,p=e.setDataAll,v=e.intl.formatMessage,h=(0,s.d4)(function(e){return e.login}).spinner,A=(0,s.wA)(),y=function(e){return A(x.yK(e))},L=function(e){return A(x.Lm(e))},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.clientId,t=e.clientIdQuery,i=e.detailsData,r=e.formatMessage,o=(0,T.A)(),s=(0,Y.P)().TabsStyle,u=(0,d.useState)(0),c=(0,l.A)(u,2),m=c[0],f=c[1];(0,d.useEffect)(function(){!n&&m&&f(0)},[n]);var p=function(e,n){return f(n)},v=(0,d.useMemo)(function(){return[{renderCondition:!0,content:function(){return i},labelId:"button.details",Icon:K.A},{renderCondition:!0,content:function(){return(0,R.jsx)(H.default,{clientId:n,clientIdQuery:t})},labelId:"nav.app.users",Icon:G.A},{renderCondition:!0,content:function(){return(0,R.jsx)(O.default,{clientId:n,clientIdQuery:t})},labelId:"nav.vehicles.and.trailers",Icon:J.A},{renderCondition:!0,content:function(){return(0,R.jsx)(P.default,{clientId:n,clientIdQuery:t})},labelId:"nav.drivers",Icon:Z.A},{renderCondition:!0,content:function(){return(0,R.jsx)(U.default,{clientId:n,clientIdQuery:t})},labelId:"nav.alarms",Icon:V.A},{renderCondition:!0,content:function(){return(0,R.jsx)(E.default,{clientId:n,clientIdQuery:t})},labelId:"nav.reports",Icon:z.A}]},[n,t,i]);return{detailsTitle:function(){return(0,R.jsx)(S.A,{value:m,onChange:p,variant:"scrollable",scrollButtons:"auto",textColor:"inherit",indicatorColor:"none",sx:s,children:null===v||void 0===v?void 0:v.map(function(e,n){var t=e.Icon,i=e.labelId;return(0,R.jsx)(F.A,(0,a.A)({icon:(0,R.jsx)(t,{className:"icon_24"}),label:r({id:i})},function(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e),sx:{minHeight:"auto"},iconPosition:"start"}}(n)),"".concat(i,"_").concat(n))})})},detailsMessage:function(){return null===v||void 0===v?void 0:v.flatMap(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.content,t=e.renderCondition,i=arguments.length>1?arguments[1]:void 0;return t?(0,R.jsx)(B,(0,a.A)((0,a.A)({value:m,index:i,dir:o.direction},i?{style:{minHeight:"75vh",padding:"0 0.25rem 1rem"}}:{}),{},{children:null===n||void 0===n?void 0:n()}),"panel_".concat(i)):(0,R.jsx)(d.Fragment,{},"empty_panel_".concat(i))})},detailsMaxWidth:m?"xxl":"lg"}}({clientId:null===i||void 0===i?void 0:i.id,clientIdQuery:(null===i||void 0===i?void 0:i.id)&&"&id_client=".concat(null===i||void 0===i?void 0:i.id),detailsData:(0,R.jsx)(q.A,{fieldData:(0,u.Un)({columns:m,editData:i})}),formatMessage:v}),X=W.detailsTitle,$=W.detailsMessage,ee=W.detailsMaxWidth,ie=(0,I.B)({modal:"add_report"===n,handleClose:t,dataName:"id_client",editDataID:null===i||void 0===i?void 0:i.id,formatMessage:v}),re=Object.assign({},((0,b.A)(ie),ie)),le=(0,d.useState)(!0),de=(0,l.A)(le,2),oe=de[0],se=de[1],ue=(0,d.useState)(!0),ce=(0,l.A)(ue,2),me=ce[0],fe=ce[1];(0,d.useEffect)(function(){"new"===n&&(null===ye||void 0===ye||ye.handleReset())},[n]);var pe=function(){var e,n={password:function(){return se(function(e){return!e})},confirm_password:function(){return fe(function(e){return!e})}};return null===(e=n[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"password"])||void 0===e?void 0:e.call(n)},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,t=e.password,l=(e.password_repeat,(0,r.A)(e,ae));return(0,a.A)((0,a.A)({},l),{},{type:null===n||void 0===n?void 0:n.id},!(null!==i&&void 0!==i&&i.id)&&(0,a.A)({},!!t&&{password:t}))},he=function(){var e=(0,g.A)((0,w.A)().m(function e(r){var l,d,o,s,c,m,v,h,A,g,b,x;return(0,w.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(y(!0),d=r&&ve(r),s=(null===(l=(o={new:function(){return{url:"/clients/add.php",postData:d}},edit:function(){return{url:"/clients/edit.php",postData:(0,a.A)({id:null===i||void 0===i?void 0:i.id},d)}},status:function(){return{url:"/clients/change_status.php",postData:{id:null===i||void 0===i?void 0:i.id}}}})[n])||void 0===l?void 0:l.call(o))||{},c=s.url,m=s.postData,v=void 0===m?null:m,h=s.actionData,!c){e.n=6;break}return e.p=1,e.n=2,(0,_.c)({method:"POST",query:c,data:v});case 2:A=e.v,g=A.data,b=(0,u.XF)(f,h||(null===g||void 0===g?void 0:g.data),n),p(b),t(),L({serverMessage:null===g||void 0===g?void 0:g.message}),e.n=4;break;case 3:e.p=3,x=e.v,L({serverMessage:(0,u.b6)(x),color:"error"});case 4:return e.p=4,y(!1),e.f(4);case 5:e.n=7;break;case 6:y(!1);case 7:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(n){return e.apply(this,arguments)}}(),Ae=(0,j.P)({initialValues:ne(i),editData:i,validationSchema:te({fieldLabels:o,formatMessage:v,editData:i}),onSubmit:he,keyName:"clients"}),ye=Ae.formik,we=Ae.renderMultipleInputs,ge=Ae.renderMultipleFilters,be=(0,d.useMemo)(function(){return[{name:"name",required:!0,label:o.name},{name:"pib",required:!0,label:o.pib,autoChange:!0,maxLength:9,type:"number"}]},[o]),xe=(0,d.useMemo)(function(){return[{name:"email_notification",required:!0,label:o.email_notification,type:"email"}]},[o]),_e=(0,d.useMemo)(function(){return[{name:"user_name",required:!0,label:o.user_name},{name:"username",required:!0,label:o.username}]},[o]),je=(0,d.useMemo)(function(){return[(0,a.A)((0,a.A)({name:"password",type:oe?"password":"text"},!i&&{required:!0}),{},{icon:(0,R.jsx)(k.A,{password_hide:oe,onClick:function(){return pe("password")}}),label:o.password,autoChange:!0}),(0,a.A)((0,a.A)({name:"password_repeat",type:me?"password":"text"},!i&&{required:!0}),{},{icon:(0,R.jsx)(k.A,{password_hide:me,onClick:function(){return pe("confirm_password")}}),label:o.password_repeat,autoChange:!0})]},[o,i,oe,me]),Ie=(0,d.useMemo)(function(){return[{name:"type",refresh:!0,url:"types/list.php?status=1",label:o.type,customData:!0,filterType:"client_type"}]},[o]);return function(){var e,r=["new","edit","details","report","add_report"].includes(n)?C.A:M.A,l={new:function(){return{title:v({id:"button.add"}),message:(0,R.jsxs)("div",{className:"mt-2",children:[we(be),ge(Ie),we(xe),(0,R.jsxs)("div",{className:"passwordWrapper",children:[we(_e),we(je)]})]}),footer:(0,R.jsx)(D.A,{handleSubmit:null===ye||void 0===ye?void 0:ye.handleSubmit,rejectAction:t,spinner:h})}},edit:function(){return{title:v({id:"modal.edit"}),message:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(q.A,{fieldData:(0,u.Un)({columns:c,editData:i})}),(0,R.jsxs)("div",{className:"mt-5",children:[ge(Ie),we(xe)]})]}),footer:(0,R.jsx)(D.A,{handleSubmit:null===ye||void 0===ye?void 0:ye.handleSubmit,rejectAction:t,spinner:h})}},add_report:function(){return re},status:function(){return{title:v({id:"modal.status"}),message:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(q.A,{fieldData:(0,u.Un)({columns:c,editData:i})}),(0,u.GC)({active:null===i||void 0===i?void 0:i.status,formatMessage:v})]}),maxWidth:"md",confirmationHandler:he,confirmButtonType:"primary"}},details:function(){return{title:X(),message:$(),maxWidth:ee,noFooter:!0}},report:function(){return{title:v({id:"nav.reports"}),message:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(q.A,{fieldData:(0,u.Un)({columns:c,editData:i})}),(0,R.jsx)(N.A,{customQuery:"&id_client=".concat(null===i||void 0===i?void 0:i.id)})]}),maxWidth:"sm",footer:(0,R.jsx)(Q.A,{buttonType:"reset",onClick:t,children:v({id:"button.close"})})}}};return(0,R.jsx)(r,(0,a.A)({open:!!n,handleClose:t,maxWidth:"sm"},null===(e=l[n])||void 0===e?void 0:e.call(l)))}()})),re=["urlQuery"],le=(0,d.memo)((0,o.Ay)(function(e){var n=e.helmet,t=e.intl.formatMessage,o=(0,s.d4)(function(e){return e.dataTable}).local_query,w=(0,d.useState)(null),g=(0,l.A)(w,2),b=g[0],x=g[1],_=(0,d.useState)(!1),j=(0,l.A)(_,2),I=j[0],C=j[1],M=(0,f.w)({roleNames:["superadmin","admin"]}),D=(0,l.A)(M,1)[0],q=(0,c.X)({url:"/types/list.php",keepQuery:!0}),k=q.data,Q=q.loading,N=(0,m.c)({formatMessage:t}),S=N.urlQuery,F=(0,r.A)(N,re),T=(0,c.X)({url:"/clients/list.php?delay=1".concat(S),hasRefetch:"details"!==I,hasModal:I,keepQuery:!0}),Y=T.data,L=T.setData,W=T.loading,X=(0,d.useMemo)(function(){return(0,u.XH)({responseData:Y,itemActiveName:"status",configData:[{itemName:"type",arrayData:k}],formatMessage:t})},[Y,k,t]),B=(0,d.useMemo)(function(){return{id:t({id:"table.number"}),chat:t({id:"notifications.messages"}),name:t({id:"client.name"}),pib:t({id:"client.cib"}),type:t({id:"client.type"}),user_name:t({id:"driver.name"}),username:t({id:"email"}),status:t({id:"filter.status"}),email_notification:t({id:"client.email.notif"}),password:t({id:"password"}),password_repeat:t({id:"repeat.password"})}},[t]),H=(0,d.useMemo)(function(){return[{field:"id",headerName:B.id,width:100,headerAlign:"center",align:"center",infoField:!0}].concat((0,i.A)(D?[{field:"chat",headerName:B.chat,width:100,headerAlign:"center",align:"center",renderCell:function(e){var n=e.row;return(0,R.jsx)(y.A,{customClientID:null===n||void 0===n?void 0:n.id,customCount:null===n||void 0===n?void 0:n.count_new})},sortable:!1}]:[]),[{field:"name",headerName:B.name,width:300,headerAlign:"center",align:"center",infoField:!0},{field:"pib",headerName:B.pib,width:250,headerAlign:"center",align:"center",renderCell:function(e){var n=e.row;return(0,R.jsx)(A.A,{data:{id:1,name:null===n||void 0===n?void 0:n.pib}})},infoField:!0},{field:"type",headerName:B.type,width:200,headerAlign:"center",align:"center",renderCell:function(e){var n=e.row;return(0,R.jsx)(A.A,{data:null===n||void 0===n?void 0:n.type})}},{field:"email_notification",headerName:B.email_notification,width:250,headerAlign:"center",align:"center"},{field:"status",headerName:B.status,width:200,headerAlign:"center",align:"center",renderCell:function(e){var n=e.row;return(0,R.jsx)(A.A,{type:"active",data:null===n||void 0===n?void 0:n.status})},infoField:!0}])},[B]),O=(0,d.useMemo)(function(){return{new_action:function(){b&&x(null),C("new")},edit:function(){return C("edit")},add_report:function(){return C("add_report")},status:function(){return C("status")},details:function(){return C("details")},report:function(){return C("report")}}},[b]);return(0,R.jsxs)(R.Fragment,{children:[null===n||void 0===n?void 0:n(t),(0,R.jsx)(p.A,(0,a.A)({search_type:"clients",fieldLabels:B},F)),(0,R.jsx)(h.A,{hasRefresh:!0,defaultCrudActions:O,disabled:!b}),(0,R.jsx)(v.A,{isActive:!0,editData:b,loading:W||Q,data:(0,u.CB)(X,o),columns:H,selectRow:x,selectRowDoubleClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(e.modalAction,e.row);x(n),C("details")},keepQuery:"details"===I}),(0,R.jsx)(ie,{modal:I,handleClose:function(){C(!1),b&&x(null)},editData:b,fieldLabels:B,columns:null===H||void 0===H?void 0:H.filter(function(e){return e.infoField}),fullColumns:H,dataAll:X,setDataAll:L})]})}))}}]);