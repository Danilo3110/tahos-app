"use strict";(self.webpackChunktahos_lat=self.webpackChunktahos_lat||[]).push([[578],{80901:function(e,n,t){t.d(n,{A:function(){return v}});var i=t(9950),r=t(54408),a=t(25333),o=t(83274),s=t(10300),l=t(83137),d=t(89379),u=t(80045),c=t(44414),m=["stroke"],f=function(e){var n=e.stroke,t=(0,u.A)(e,m);return(0,c.jsxs)("svg",(0,d.A)((0,d.A)({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),{},{children:[(0,c.jsx)("path",{opacity:"0.4",d:"M15.58 12C15.58 13.98 13.98 15.58 12 15.58C10.02 15.58 8.42004 13.98 8.42004 12C8.42004 10.02 10.02 8.42004 12 8.42004C13.98 8.42004 15.58 10.02 15.58 12Z",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{d:"M12 20.27C15.53 20.27 18.82 18.19 21.11 14.59C22.01 13.18 22.01 10.81 21.11 9.39997C18.82 5.79997 15.53 3.71997 12 3.71997C8.46997 3.71997 5.17997 5.79997 2.88997 9.39997C1.98997 10.81 1.98997 13.18 2.88997 14.59C5.17997 18.19 8.46997 20.27 12 20.27Z",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}))},p=["stroke"],h=function(e){var n=e.stroke,t=(0,u.A)(e,p);return(0,c.jsxs)("svg",(0,d.A)((0,d.A)({width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),{},{children:[(0,c.jsx)("path",{d:"M14.53 9.69246L9.46998 14.7525C8.81998 14.1025 8.41998 13.2125 8.41998 12.2225C8.41998 10.2425 10.02 8.64246 12 8.64246C12.99 8.64246 13.88 9.04246 14.53 9.69246Z",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{d:"M17.82 5.99239C16.07 4.67239 14.07 3.95239 12 3.95239C8.47003 3.95239 5.18003 6.03239 2.89003 9.63239C1.99003 11.0424 1.99003 13.4124 2.89003 14.8224C3.68003 16.0624 4.60003 17.1324 5.60003 17.9924",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{opacity:"0.4",d:"M8.41998 19.7525C9.55998 20.2325 10.77 20.4925 12 20.4925C15.53 20.4925 18.82 18.4125 21.11 14.8125C22.01 13.4025 22.01 11.0325 21.11 9.62247C20.78 9.10247 20.42 8.61247 20.05 8.15247",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{opacity:"0.4",d:"M15.51 12.9224C15.25 14.3324 14.1 15.4824 12.69 15.7424",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{d:"M9.47 14.7524L2 22.2224",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,c.jsx)("path",{d:"M22 2.22241L14.53 9.69241",stroke:n||"#0f0f0f",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}))},v=(0,i.memo)((0,r.Ay)(function(e){var n=e.onClick,t=e.password_hide,r=e.intl.formatMessage,d=(0,s.d4)(function(e){return e.app}).themeColors,u=(0,i.useMemo)(function(){return{"&.MuiButtonBase-root.MuiIconButton-root":{"&:hover":{backgroundColor:(0,l.DA)(d["--gray-color-2"],.15)}}}},[d]),m=(0,i.useMemo)(function(){return{Icon:t?h:f,title:r({id:t?"button.show.password":"datagrid.columnMenuHideColumn"})}},[t,r]),p=m.Icon,v=m.title;return(0,c.jsx)(o.A,{arrow:!0,title:v,children:(0,c.jsx)(a.A,{sx:u,onClick:n,children:(0,c.jsx)(p,{className:"icon_24",stroke:d["--text-color"]})})})}))},92578:function(e,n,t){t.r(n),t.d(n,{default:function(){return B}});var i=t(60436),r=t(80045),a=t(89379),o=t(5544),s=t(9950),l=t(54408),d=t(10300),u=t(83137),c=t(95250),m=t(82109),f=t(4297),p=t(49389),h=t(27162),v=t(65510),w=t(67078),A=t(91212),k=t(10467),g=t(45131),j=t(93320),C=t(73275),x=t(17419),_=t(70298),M=t(70742),b=t(39412),y=t(80901),D=t(85546),L=t(29714),q=function(e){var n=e.editData,t=e.showClientField,i=e.hasPermission;return(0,a.A)((0,a.A)((0,a.A)({},!(null!==n&&void 0!==n&&n.id)&&(0,a.A)({name:""},t&&{client_name:null})),{},{username:""},i&&{role:null}),{},{email_notification:"",password:"",password_repeat:""})},N=function(e){var n=e.fieldLabels,t=e.formatMessage,i=e.editData,r=e.showClientField,o=e.hasPermission;return(0,L.Ik)().shape((0,a.A)((0,a.A)((0,a.A)({},!(null!==i&&void 0!==i&&i.id)&&(0,a.A)({name:(0,L.Yj)().required((0,D.w)(t,n.name,"required"))},r&&{client_name:(0,L.Ik)().required((0,D.w)(t,n.client_name,"filter"))})),{},{username:(0,L.Yj)().required((0,D.w)(t,n.username,"required"))},o&&{role:(0,L.Ik)().required((0,D.w)(t,n.role,"filter"))}),{},{email_notification:(0,L.Yj)().email(t({id:"email.validation"})).required((0,D.w)(t,n.email_notification,"required")),password:(0,L.Yj)().min(8,(0,D.w)(t,n.password,"password")).concat(i?null:(0,L.Yj)().required((0,D.w)(t,n.password,"required"))),password_repeat:(0,L.Yj)().oneOf([(0,L.KR)("password")],t({id:"not.the.same.password"})).concat(i?null:(0,L.Yj)().required((0,D.w)(t,n.password_repeat,"required")))}))},F=t(44414),W=["role","name","client_name","password","password_repeat"],I=(0,s.memo)((0,l.Ay)(function(e){var n=e.modal,t=e.handleClose,l=e.editData,c=e.fieldLabels,f=e.columns,p=e.dataAll,h=e.setDataAll,v=e.intl.formatMessage,w=(0,d.d4)(function(e){return e.login}).spinner,D=(0,d.wA)(),L=function(e){return D(g.yK(e))},I=function(e){return D(g.Lm(e))},S=(0,m.w)({roleNames:["superadmin","admin","podadmin"]}),B=(0,o.A)(S,1)[0],Q=(0,s.useState)(!0),Y=(0,o.A)(Q,2),P=Y[0],R=Y[1],X=(0,s.useState)(!0),H=(0,o.A)(X,2),T=H[0],Z=H[1];(0,s.useEffect)(function(){"new"===n&&(null===G||void 0===G||G.handleReset())},[n]);var K=function(){var e,n={password:function(){return R(function(e){return!e})},confirm_password:function(){return Z(function(e){return!e})}};return null===(e=n[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"password"])||void 0===e?void 0:e.call(n)},O=function(){var e=((null===G||void 0===G?void 0:G.values)||{}).role,n=(null===e||void 0===e?void 0:e.name)&&!["superadmin","admin","podadmin"].includes(null===e||void 0===e?void 0:e.name);return B&&n},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.role,t=e.name,i=e.client_name,o=e.password,s=(e.password_repeat,(0,r.A)(e,W));return(0,a.A)((0,a.A)((0,a.A)((0,a.A)({},s),B&&{role:null===n||void 0===n?void 0:n.id}),!(null!==l&&void 0!==l&&l.id)&&(0,a.A)({name:t},O()&&{id_client:null===i||void 0===i?void 0:i.id})),!!o&&{password:o})},z=function(){var e=(0,k.A)((0,A.A)().m(function e(i){var r,o,s,d,c,m,f,v,w,k,g,C;return(0,A.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(L(!0),o=i&&U(i),d=(null===(r=(s={new:function(){return{url:"/users/add.php",postData:o}},edit:function(){return{url:"/users/edit.php",postData:(0,a.A)({id:null===l||void 0===l?void 0:l.id},o)}},status:function(){return{url:"/users/change_status.php",postData:{id:null===l||void 0===l?void 0:l.id}}}})[n])||void 0===r?void 0:r.call(s))||{},c=d.url,m=d.postData,f=void 0===m?null:m,v=d.actionData,!c){e.n=6;break}return e.p=1,e.n=2,(0,j.c)({method:"POST",query:c,data:f});case 2:w=e.v,k=w.data,g=(0,u.XF)(p,v||(null===k||void 0===k?void 0:k.data),n),h(g),t(),I({serverMessage:null===k||void 0===k?void 0:k.message}),e.n=4;break;case 3:e.p=3,C=e.v,I({serverMessage:(0,u.b6)(C),color:"error"});case 4:return e.p=4,L(!1),e.f(4);case 5:e.n=7;break;case 6:L(!1);case 7:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(n){return e.apply(this,arguments)}}(),E=(0,C.P)({initialValues:q({editData:l,showClientField:O(),hasPermission:B}),editData:l,validationSchema:N({fieldLabels:c,formatMessage:v,editData:l,showClientField:O(),hasPermission:B}),onSubmit:z,keyName:"app_users"}),G=E.formik,V=E.renderMultipleInputs,J=E.renderMultipleFilters,$=(0,s.useMemo)(function(){return[].concat((0,i.A)(null!==l&&void 0!==l&&l.id?[]:[{name:"name",required:!0,label:c.name}]),[{name:"username",required:!0,label:c.username}])},[l,c]),ee=(0,s.useMemo)(function(){return[{name:"email_notification",required:!0,label:c.email_notification,type:"email"}]},[c]),ne=(0,s.useMemo)(function(){return[(0,a.A)((0,a.A)({name:"password",type:P?"password":"text"},!l&&{required:!0}),{},{icon:(0,F.jsx)(y.A,{password_hide:P,onClick:function(){return K("password")}}),label:c.password,autoChange:!0}),(0,a.A)((0,a.A)({name:"password_repeat",type:T?"password":"text"},!l&&{required:!0}),{},{icon:(0,F.jsx)(y.A,{password_hide:T,onClick:function(){return K("confirm_password")}}),label:c.password_repeat,autoChange:!0})]},[c,l,P,T]),te=(0,s.useMemo)(function(){return[{name:"role",refresh:!0,url:"roles/list.php",customData:!0,filterType:"role",label:c.role,required:!0}].concat((0,i.A)(null!==l&&void 0!==l&&l.id||!O()?[]:[{name:"client_name",refresh:!0,url:"clients/list.php?status=1",label:c.client_name,required:!0}]))},[l,c,O]);return function(){var e,i=["new","edit"].includes(n)?x.A:_.A,r={new:function(){return{title:v({id:"button.add"}),message:(0,F.jsxs)("div",{className:"mt-2",children:[V($),!!B&&J(te),V(ee),(0,F.jsx)("div",{className:"passwordWrapper",children:V(ne)})]}),footer:(0,F.jsx)(M.A,{handleSubmit:null===G||void 0===G?void 0:G.handleSubmit,rejectAction:t,spinner:w})}},edit:function(){return{title:v({id:"modal.edit"}),message:(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(b.A,{fieldData:(0,u.Un)({columns:f,editData:l})}),(0,F.jsxs)("div",{className:"mt-5",children:[V($),!!B&&J(te),V(ee),(0,F.jsx)("div",{className:"passwordWrapper",children:V(ne)})]})]}),footer:(0,F.jsx)(M.A,{handleSubmit:null===G||void 0===G?void 0:G.handleSubmit,rejectAction:t,spinner:w})}},status:function(){return{title:v({id:"modal.status"}),message:(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(b.A,{fieldData:(0,u.Un)({columns:f,editData:l})}),(0,u.GC)({active:null===l||void 0===l?void 0:l.status,formatMessage:v})]}),maxWidth:"md",confirmationHandler:z,confirmButtonType:"primary"}}};return(0,F.jsx)(i,(0,a.A)({open:!!n,handleClose:t,maxWidth:"sm"},null===(e=r[n])||void 0===e?void 0:e.call(r)))}()})),S=["urlQuery"],B=(0,s.memo)((0,l.Ay)(function(e){var n=e.clientId,t=e.clientIdQuery,l=void 0===t?"":t,A=e.helmet,k=e.intl.formatMessage,g=(0,d.d4)(function(e){return e.dataTable}).local_query,j=(0,m.w)({roleNames:["superadmin","admin","podadmin"]}),C=(0,o.A)(j,1)[0],x=(0,c.X)({url:C&&"/roles/list.php",customDataHandler:function(e){return null===e||void 0===e?void 0:e.map(function(e){return(0,a.A)((0,a.A)({},e),{},{name:null===e||void 0===e?void 0:e.naziv})})},keepQuery:!0}),_=x.data,M=x.loading,b=(0,c.X)({url:C&&!n&&"/clients/list.php",keepQuery:!0}),y=b.data,D=b.loading,L=(0,f.c)({clientId:n,clientIdQuery:l,formatMessage:k}),q=L.urlQuery,N=(0,r.A)(L,S),W=(0,c.X)({url:"/users/list.php?delay=1".concat(q),hasRefetch:!0,keepQuery:!0}),B=W.data,Q=W.setData,Y=W.loading,P=(0,s.useMemo)(function(){return(0,u.XH)({responseData:B,itemActiveName:"status",configData:[{itemName:"role",arrayData:_},{itemName:"client_name",arrayData:y}],formatMessage:k})},[B,_,y,k]),R=(0,s.useState)(null),X=(0,o.A)(R,2),H=X[0],T=X[1],Z=(0,s.useState)(!1),K=(0,o.A)(Z,2),O=K[0],U=K[1],z=(0,s.useMemo)(function(){return{id:k({id:"table.number"}),name:k({id:"app.users.name"}),role:k({id:"role.1"}),username:k({id:"email"}),client_name:k({id:"client.name"}),email_notification:k({id:"client.email.notif"}),status:k({id:"filter.status"}),password:k({id:"password"}),password_repeat:k({id:"repeat.password"})}},[k]),E=(0,s.useMemo)(function(){return[{field:"id",headerName:z.id,width:100,headerAlign:"center",align:"center",infoField:!0},{field:"name",headerName:z.name,width:300,headerAlign:"center",align:"center",infoField:!0}].concat((0,i.A)(C?[{field:"role",headerName:z.role,width:200,headerAlign:"center",align:"center",renderCell:function(e){var n=e.row;return(0,F.jsx)(w.A,{data:null===n||void 0===n?void 0:n.role})}}]:[]),[{field:"username",headerName:z.username,width:280,headerAlign:"center",align:"center"}],(0,i.A)(C&&!n?[{field:"client_name",headerName:z.client_name,width:250,headerAlign:"center",align:"center",renderCell:function(e){var n,t=e.row;return(null===t||void 0===t||null===(n=t.client_name)||void 0===n?void 0:n.name)||"-"},infoField:!0}]:[]),[{field:"email_notification",headerName:z.email_notification,width:250,headerAlign:"center",align:"center"},{field:"status",headerName:z.status,width:200,headerAlign:"center",align:"center",renderCell:function(e){var n=e.row;return(0,F.jsx)(w.A,{type:"active",data:null===n||void 0===n?void 0:n.status})},infoField:!0}])},[z,C,n]),G=(0,s.useMemo)(function(){return{new_action:function(){H&&T(null),U("new")},edit:function(){return U("edit")},status:function(){return U("status")}}},[H]);return(0,F.jsxs)(F.Fragment,{children:[null===A||void 0===A?void 0:A(k),(0,F.jsx)(p.A,(0,a.A)({search_type:"app_users",fieldLabels:z,roleCondition:C&&!n},N)),(0,F.jsx)(v.A,{hasRefresh:!0,defaultCrudActions:G,disabled:!H}),(0,F.jsx)(h.A,{isActive:!0,editData:H,loading:Y||M||D,data:(0,u.CB)(P,g),columns:E,selectRow:T,selectRowDoubleClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.modalAction,t=e.row;T(t),U(n)}}),(0,F.jsx)(I,{modal:O,handleClose:function(){U(!1),H&&T(null)},editData:H,fieldLabels:z,columns:null===E||void 0===E?void 0:E.filter(function(e){return e.infoField}),dataAll:P,setDataAll:Q})]})}))}}]);